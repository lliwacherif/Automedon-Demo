import{d as P,u as V,r as d,V as A,e as i,o as a,g as e,f as m,h as x,k as c,i as b,j as p,v as f,b as w,O as h}from"./index-BDZ5CRY0.js";import{L as k}from"./loader-circle-fvkBEavV.js";const L={class:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},C={class:"sm:mx-auto sm:w-full sm:max-w-md"},U={class:"mt-6 text-center text-3xl font-extrabold text-gray-900"},j={key:0,class:"mt-2 text-center text-sm text-gray-600"},q={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},B={class:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},N={class:"mt-1"},M={class:"mt-1"},D={key:0,class:"text-red-600 text-sm"},T=["disabled"],E={class:"mt-1"},F={class:"mt-1"},O={key:0,class:"text-red-600 text-sm"},W=["disabled"],I=P({__name:"Login",setup(z){const r=V(),g=d(""),v=d(""),u=d(""),y=d(""),t=d(""),o=d(!1);A(async()=>{try{await r.checkAdminSetup()}catch(l){console.error("Failed to check checks setup",l)}});async function _(){t.value="",o.value=!0;try{await r.loginAdmin(g.value,v.value)}catch(l){t.value=l.message}finally{o.value=!1}}async function S(){if(t.value="",u.value.length<6){t.value="Password must be at least 6 characters";return}if(u.value!==y.value){t.value="Passwords do not match";return}o.value=!0;try{await r.setupAdminPassword(u.value)}catch(l){t.value=l.message}finally{o.value=!1}}return(l,s)=>(a(),i("div",L,[e("div",C,[e("h2",U,x(c(r).isSetup?"Admin Login":"Setup Admin Password"),1),c(r).isSetup?m("",!0):(a(),i("p",j," Welcome! Please set your admin password to get started. "))]),e("div",q,[e("div",B,[c(r).isSetup?(a(),i("form",{key:0,class:"space-y-6",onSubmit:b(_,["prevent"])},[e("div",null,[s[4]||(s[4]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Username ",-1)),e("div",N,[p(e("input",{id:"username","onUpdate:modelValue":s[0]||(s[0]=n=>g.value=n),name:"username",type:"text",required:"",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[f,g.value]])])]),e("div",null,[s[5]||(s[5]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Password ",-1)),e("div",M,[p(e("input",{id:"password","onUpdate:modelValue":s[1]||(s[1]=n=>v.value=n),name:"password",type:"password",required:"",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[f,v.value]])])]),t.value?(a(),i("div",D,x(t.value),1)):m("",!0),e("div",null,[e("button",{type:"submit",disabled:o.value,class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"},[o.value?(a(),w(c(k),{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):m("",!0),s[6]||(s[6]=h(" Sign in ",-1))],8,T)])],32)):(a(),i("form",{key:1,class:"space-y-6",onSubmit:b(S,["prevent"])},[e("div",null,[s[7]||(s[7]=e("label",{for:"setup-password",class:"block text-sm font-medium text-gray-700"}," New Password ",-1)),e("div",E,[p(e("input",{id:"setup-password","onUpdate:modelValue":s[2]||(s[2]=n=>u.value=n),name:"setup-password",type:"password",required:"",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[f,u.value]])])]),e("div",null,[s[8]||(s[8]=e("label",{for:"setup-confirm",class:"block text-sm font-medium text-gray-700"}," Confirm Password ",-1)),e("div",F,[p(e("input",{id:"setup-confirm","onUpdate:modelValue":s[3]||(s[3]=n=>y.value=n),name:"setup-confirm",type:"password",required:"",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[f,y.value]])])]),t.value?(a(),i("div",O,x(t.value),1)):m("",!0),e("div",null,[e("button",{type:"submit",disabled:o.value,class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"},[o.value?(a(),w(c(k),{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):m("",!0),s[9]||(s[9]=h(" Set Password & Login ",-1))],8,W)])],32))])])]))}});export{I as default};
