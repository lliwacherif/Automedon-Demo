import{t as ee,c as ne,d as Z,u as oe,r as x,a as I,w as H,b as J,o as a,e as i,f as D,g as e,h as d,i as re,j as y,v as C,k as r,l as X,F as S,m as j,T as le,s as ie,n as de,p as ue,q as ce,x as me,y as N,z as L,A as P,B as te,C as w,D as ge,E as ve,G,X as pe,H as z,I as fe,J as xe,K as be,L as K,M as ye,N as he,O as ae,P as _e,Q as we,R as E,S as ke,U as $e,_ as Ce,V as De,W as Me}from"./index-BQIPyYnB.js";import{u as Ve}from"./useCars-CoUnl4kt.js";import{u as Le}from"./useReservations-PBA4lJzv.js";import{f as se,a as Q}from"./date-BpD5EXL9.js";import{E as Se}from"./eye-zx5LkDhc.js";function Y(T,A){const h=+ee(T)-+ee(A);return h<0?-1:h>0?1:h}/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=ne("ClockIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ae={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Re={class:"flex min-h-full items-center justify-center p-4"},Ue={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Ie={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},Te={key:0,class:"text-sm text-gray-500 mt-1"},qe={key:0,class:"p-6"},Oe={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm"},Be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ze={class:"flex space-x-2 mt-1"},Ee=["min"],Xe={class:"flex w-1/2 items-center gap-1"},Fe=["value"],He=["value"],Je={key:0,class:"mt-1 text-xs text-indigo-600 font-medium"},We={class:"flex space-x-2 mt-1"},Pe=["min"],Ge={class:"flex w-1/2 items-center gap-1"},Ke=["value"],Qe=["value"],Ye={key:0,class:"mt-1 text-xs text-indigo-600 font-medium"},Ze={key:1,class:"bg-indigo-50 rounded-lg p-4"},et={class:"space-y-2 text-sm"},tt={class:"flex justify-between"},st={class:"font-medium text-indigo-900"},ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},lt={class:"mt-4"},at={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},nt=["disabled"],rt={key:0},it={key:1},dt=Z({__name:"ReservationModal",props:{show:{type:Boolean},car:{}},emits:["close","success"],setup(T,{emit:A}){const h=T,M=A,{createReservation:g,loading:k}=Le(),$=oe(),s=x({client_name:"",client_cin:"",client_phone:"",client_email:$.user?.email||"",start_date:"",end_date:"",price_per_day:150,pickup_location:"",return_location:"",notes:""}),f=x(""),V=x(!1),_=I(()=>{if(!s.value.start_date||!s.value.end_date)return 0;const p=new Date(s.value.start_date),t=new Date(s.value.end_date),o=Math.ceil((t.getTime()-p.getTime())/(1e3*60*60*24));return o>0?o:0}),R=I(()=>_.value*s.value.price_per_day),q=Array.from({length:24},(p,t)=>String(t).padStart(2,"0")),O=["00","30"],c=x(""),u=x("09"),m=x("00"),U=x(""),v=x("09"),l=x("00");H([c,u,m],([p,t,o])=>{if(p&&t&&o){const W=o.padStart(2,"0");s.value.start_date=`${p}T${t}:${W}`}else s.value.start_date=""}),H([U,v,l],([p,t,o])=>{if(p&&t&&o){const W=o.padStart(2,"0");s.value.end_date=`${p}T${t}:${W}`}else s.value.end_date=""}),H(()=>h.show,p=>{p&&(s.value={client_name:"",client_cin:"",client_phone:"",client_email:$.user?.email||"",start_date:"",end_date:"",price_per_day:150,pickup_location:"",return_location:"",notes:""},c.value="",u.value="09",m.value="00",U.value="",v.value="09",l.value="00",f.value="",V.value=!1)});const n=()=>s.value.client_name.trim()?s.value.client_cin.trim()?s.value.client_phone.trim()?s.value.start_date?s.value.end_date?_.value<=0?(f.value="La date de fin doit être après la date de début",!1):(f.value="",!0):(f.value="La date de fin est requise",!1):(f.value="La date de début est requise",!1):(f.value="Le téléphone est requis",!1):(f.value="Le CIN est requis",!1):(f.value="Le nom est requis",!1),b=async()=>{if(!(!n()||!h.car))try{await g({user_id:$.user?.id||null,car_id:h.car.id,client_name:s.value.client_name,client_cin:s.value.client_cin,client_phone:s.value.client_phone,client_email:s.value.client_email||null,start_date:s.value.start_date,end_date:s.value.end_date,duration_days:_.value,price_per_day:s.value.price_per_day,total_price:R.value,status:"confirmed",pickup_location:s.value.pickup_location||null,return_location:s.value.return_location||null,notes:s.value.notes||null}),V.value=!0,setTimeout(()=>{M("success"),M("close")},2e3)}catch(p){f.value=p.message||"Une erreur est survenue"}},B=()=>{M("close")},F=new Date().toISOString().split("T")[0];return(p,t)=>(a(),J(le,{to:"body"},[p.show?(a(),i("div",Ae,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:B}),e("div",Re,[e("div",Ue,[e("div",Ie,[e("div",null,[t[13]||(t[13]=e("h2",{class:"text-xl font-semibold text-gray-900"},"Réserver une voiture",-1)),p.car?(a(),i("p",Te,d(p.car.brand)+" "+d(p.car.model)+" - "+d(p.car.plate_number),1)):D("",!0)]),e("button",{onClick:B,class:"text-gray-400 hover:text-gray-500"},[...t[14]||(t[14]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),V.value?(a(),i("div",qe,[...t[15]||(t[15]=[e("div",{class:"text-center"},[e("div",{class:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100"},[e("svg",{class:"h-8 w-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])]),e("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Réservation envoyée !"),e("p",{class:"mt-2 text-sm text-gray-500"}," Votre demande de réservation a été envoyée avec succès. Vous recevrez une confirmation sous peu. ")],-1)])])):(a(),i("form",{key:1,onSubmit:re(b,["prevent"]),class:"p-6 space-y-6"},[f.value?(a(),i("div",Oe,d(f.value),1)):D("",!0),e("div",null,[t[20]||(t[20]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations personnelles",-1)),e("div",Be,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom complet *",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.client_name=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Votre nom complet"},null,512),[[C,s.value.client_name]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"CIN *",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.client_cin=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Numéro de carte d'identité"},null,512),[[C,s.value.client_cin]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Téléphone *",-1)),y(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.client_phone=o),type:"tel",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"+216 XX XXX XXX"},null,512),[[C,s.value.client_phone]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.client_email=o),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"votre@email.com"},null,512),[[C,s.value.client_email]])])])]),e("div",null,[t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Dates de location",-1)),e("div",Ne,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date de début *",-1)),e("div",ze,[y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>c.value=o),type:"date",min:r(F),required:"",class:"block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Ee),[[C,c.value]]),e("div",Xe,[y(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>u.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(a(!0),i(S,null,j(r(q),o=>(a(),i("option",{key:o,value:o},d(o),9,Fe))),128))],512),[[X,u.value]]),t[21]||(t[21]=e("span",{class:"text-gray-500 font-bold"},":",-1)),y(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>m.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(a(),i(S,null,j(O,o=>e("option",{key:o,value:o},d(o),9,He)),64))],512),[[X,m.value]])])]),s.value.start_date?(a(),i("p",Je,d(r(se)(s.value.start_date)),1)):D("",!0)]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date de fin *",-1)),e("div",We,[y(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>U.value=o),type:"date",min:c.value||r(F),required:"",class:"block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Pe),[[C,U.value]]),e("div",Ge,[y(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>v.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(a(!0),i(S,null,j(r(q),o=>(a(),i("option",{key:o,value:o},d(o),9,Ke))),128))],512),[[X,v.value]]),t[23]||(t[23]=e("span",{class:"text-gray-500 font-bold"},":",-1)),y(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>l.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(a(),i(S,null,j(O,o=>e("option",{key:o,value:o},d(o),9,Qe)),64))],512),[[X,l.value]])])]),s.value.end_date?(a(),i("p",Ye,d(r(se)(s.value.end_date)),1)):D("",!0)])])]),_.value>0?(a(),i("div",Ze,[t[27]||(t[27]=e("h3",{class:"text-lg font-medium text-indigo-900 mb-2"},"Récapitulatif",-1)),e("div",et,[e("div",tt,[t[26]||(t[26]=e("span",{class:"text-indigo-700"},"Durée",-1)),e("span",st,d(_.value)+" jour(s)",1)])])])):D("",!0),e("div",null,[t[31]||(t[31]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations supplémentaires",-1)),e("div",ot,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lieu de prise en charge",-1)),y(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>s.value.pickup_location=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Aéroport, agence, etc."},null,512),[[C,s.value.pickup_location]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lieu de retour",-1)),y(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>s.value.return_location=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Aéroport, agence, etc."},null,512),[[C,s.value.return_location]])])]),e("div",lt,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),y(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=o=>s.value.notes=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Informations complémentaires..."},null,512),[[C,s.value.notes]])])]),e("div",at,[e("button",{type:"button",onClick:B,class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Annuler "),e("button",{type:"submit",disabled:r(k)||_.value<=0,class:"px-4 py-2 bg-indigo-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"},[r(k)?(a(),i("span",rt,"Envoi en cours...")):(a(),i("span",it,"Confirmer la réservation"))],8,nt)])],32))])])])):D("",!0)]))}}),ut={key:0,class:"fixed inset-0 z-[100]",role:"dialog","aria-modal":"true"},ct={class:"fixed inset-0 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 w-full h-full sm:w-[95vw] sm:max-w-[900px] sm:h-auto sm:max-h-[90vh] sm:rounded-2xl bg-white shadow-2xl overflow-hidden flex flex-col"},mt={class:"sticky top-0 z-20 flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b bg-white/95 backdrop-blur-sm"},gt={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},vt={class:"p-1.5 sm:p-2 bg-indigo-100 rounded-lg shrink-0"},pt={class:"min-w-0"},ft={class:"text-sm sm:text-lg font-semibold text-gray-900 truncate"},xt={class:"flex-1 overflow-y-auto overscroll-contain"},bt={class:"p-4 sm:p-6"},yt={class:"min-w-0 flex-1"},ht={key:0,class:"text-xs sm:text-sm text-red-600/80 mt-0.5"},_t={class:"flex flex-col lg:flex-row gap-4 sm:gap-6 lg:gap-8"},wt={class:"flex-1 min-w-0"},kt={class:"bg-gray-50/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-gray-100"},$t={class:"flex items-center justify-between mb-3 sm:mb-4"},Ct={class:"text-base sm:text-lg font-semibold text-gray-800 capitalize"},Dt={class:"select-none"},Mt={class:"grid grid-cols-7 gap-1 mb-2"},Vt={class:"sm:hidden"},Lt={class:"hidden sm:inline"},St={class:"grid grid-cols-7 gap-1"},jt=["datetime"],At={class:"lg:w-80 shrink-0"},Rt={class:"bg-gray-50/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-gray-100 h-full"},Ut={class:"flex items-center justify-between mb-3 sm:mb-4"},It={class:"text-sm sm:text-base font-semibold text-gray-800 flex items-center gap-2"},Tt={class:"text-xs font-medium text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded-full"},qt={key:0,class:"flex flex-col items-center justify-center py-8 sm:py-12 text-center"},Ot={class:"p-3 sm:p-4 bg-gray-100 rounded-full mb-3"},Bt={key:1,class:"space-y-2 sm:space-y-3 max-h-[200px] lg:max-h-[300px] overflow-y-auto overscroll-contain pr-1 custom-scrollbar"},Nt={class:"flex items-start gap-2 sm:gap-3"},zt={class:"p-1.5 sm:p-2 bg-indigo-50 rounded-lg shrink-0"},Et={class:"flex-1 min-w-0 space-y-1.5"},Xt={class:"flex items-center gap-1.5 text-xs sm:text-sm text-gray-600"},Ft={class:"truncate"},Ht={class:"flex items-center gap-1.5 text-xs sm:text-sm text-gray-600"},Jt={class:"truncate"},Wt=Z({__name:"CarAvailabilityModal",props:{show:{type:Boolean},car:{}},emits:["close"],setup(T,{emit:A}){const h=T,M=A,g=x(new Date),k=x([]),$=x(!1);H(()=>[h.show,h.car],async([v,l])=>{v&&l&&await s(l.id)},{immediate:!0});async function s(v){$.value=!0;try{const{data:l,error:n}=await $e.from("reservations").select("start_date, end_date, status").eq("car_id",v).in("status",["confirmed","active"]);if(n)throw n;const b=N(new Date);k.value=(l||[]).filter(B=>{const F=P(L(B.end_date));return Y(F,b)>=0})}catch(l){console.error("Error fetching reservations:",l)}finally{$.value=!1}}const f=I(()=>{const v=ie(g.value),l=de(g.value),n=ue(v,{weekStartsOn:1}),b=ce(l,{weekStartsOn:1});return me({start:n,end:b})});function V(v){return k.value.some(l=>{const n=N(L(l.start_date)),b=P(L(l.end_date));return te(v,{start:n,end:b})})}const _=I(()=>{const v=new Date;return k.value.find(l=>{const n=N(L(l.start_date)),b=P(L(l.end_date));return te(v,{start:n,end:b})})}),R=I(()=>{const v=N(new Date);return k.value.filter(n=>{const b=N(L(n.start_date));return Y(b,v)>=0}).sort((n,b)=>Y(L(n.start_date),L(b.start_date)))});function q(){g.value=_e(g.value,1)}function O(){g.value=we(g.value)}function c(){M("close")}const u=I(()=>!_.value),m=["L","M","M","J","V","S","D"],U=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];return(v,l)=>(a(),J(le,{to:"body"},[w(ge,{"enter-active-class":"transition-opacity duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:ve(()=>[v.show?(a(),i("div",ut,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm","aria-hidden":"true",onClick:c}),e("div",ct,[e("div",mt,[e("div",gt,[e("div",vt,[w(r(G),{class:"w-4 h-4 sm:w-5 sm:h-5 text-indigo-600"})]),e("div",pt,[e("h3",ft,d(v.car?.brand)+" "+d(v.car?.model),1),l[0]||(l[0]=e("p",{class:"text-xs text-gray-500 hidden sm:block"},"Calendrier de disponibilité",-1))])]),e("button",{onClick:c,class:"p-2 -mr-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors touch-manipulation"},[w(r(pe),{class:"h-5 w-5 sm:h-6 sm:w-6 text-gray-500"}),l[1]||(l[1]=e("span",{class:"sr-only"},"Fermer",-1))])]),e("div",xt,[e("div",bt,[e("div",{class:z(["flex items-center gap-3 p-3 sm:p-4 rounded-xl mb-4 sm:mb-6 transition-all",u.value?"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200":"bg-gradient-to-r from-red-50 to-orange-50 border border-red-200"])},[e("div",{class:z(["p-2 sm:p-2.5 rounded-full shrink-0",u.value?"bg-green-100":"bg-red-100"])},[u.value?(a(),J(r(fe),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"})):(a(),J(r(xe),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-red-600"}))],2),e("div",yt,[e("p",{class:z(["font-semibold text-sm sm:text-base",u.value?"text-green-700":"text-red-700"])},d(u.value?"✓ Disponible aujourd'hui":"✗ Actuellement Loué"),3),!u.value&&_.value?(a(),i("p",ht," Jusqu'au "+d(r(Q)(_.value.end_date)),1)):D("",!0)])],2),e("div",_t,[e("div",wt,[e("div",kt,[e("div",$t,[e("button",{onClick:O,class:"p-2 sm:p-2.5 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation shadow-sm"},[w(r(be),{class:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})]),e("div",Ct,d(r(K)(g.value,"MMMM yyyy",{locale:r(ye)})),1),e("button",{onClick:q,class:"p-2 sm:p-2.5 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation shadow-sm"},[w(r(he),{class:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})])]),e("div",Dt,[e("div",Mt,[(a(),i(S,null,j(U,(n,b)=>e("div",{key:n,class:"text-center py-2 text-xs sm:text-sm font-medium text-gray-500"},[e("span",Vt,d(m[b]),1),e("span",Lt,d(n),1)])),64))]),e("div",St,[(a(!0),i(S,null,j(f.value,n=>(a(),i("div",{key:n.toISOString(),class:"relative aspect-square"},[e("div",{class:z(["absolute inset-0.5 sm:inset-1 flex flex-col items-center justify-center rounded-lg sm:rounded-xl transition-all duration-150",[r(E)(n,g.value)?"":"opacity-25",r(ke)(n)&&r(E)(n,g.value)?"ring-2 ring-indigo-400 ring-offset-1":"",r(E)(n,g.value)&&V(n)?"bg-red-100 text-red-700":r(E)(n,g.value)?"bg-green-50 text-green-700 hover:bg-green-100":"bg-gray-100 text-gray-400"]])},[e("time",{datetime:r(K)(n,"yyyy-MM-dd"),class:"text-xs sm:text-sm font-medium"},d(r(K)(n,"d")),9,jt),r(E)(n,g.value)?(a(),i("div",{key:0,class:z(["w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full mt-0.5",V(n)?"bg-red-500":"bg-green-500"])},null,2)):D("",!0)],2)]))),128))])]),l[2]||(l[2]=e("div",{class:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-200 flex items-center justify-center gap-4 sm:gap-6"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("span",{class:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-green-500"}),e("span",{class:"text-xs sm:text-sm text-gray-600"},"Disponible")]),e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("span",{class:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-red-500"}),e("span",{class:"text-xs sm:text-sm text-gray-600"},"Réservé")])],-1))])]),e("div",At,[e("div",Rt,[e("div",Ut,[e("h4",It,[w(r(je),{class:"w-4 h-4 text-indigo-500"}),l[3]||(l[3]=ae(" Réservations à venir ",-1))]),e("span",Tt,d(R.value.length),1)]),R.value.length===0?(a(),i("div",qt,[e("div",Ot,[w(r(G),{class:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400"})]),l[4]||(l[4]=e("p",{class:"text-sm text-gray-500"},"Aucune réservation",-1)),l[5]||(l[5]=e("p",{class:"text-xs text-gray-400 mt-1"},"Ce véhicule est libre",-1))])):(a(),i("div",Bt,[(a(!0),i(S,null,j(R.value,n=>(a(),i("div",{key:n.id,class:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 border border-gray-200 shadow-sm"},[e("div",Nt,[e("div",zt,[w(r(G),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-indigo-600"})]),e("div",Et,[e("div",Xt,[l[6]||(l[6]=e("span",{class:"w-1.5 h-1.5 rounded-full bg-green-400 shrink-0"},null,-1)),e("span",Ft,d(r(Q)(n.start_date)),1)]),e("div",Ht,[l[7]||(l[7]=e("span",{class:"w-1.5 h-1.5 rounded-full bg-red-400 shrink-0"},null,-1)),e("span",Jt,d(r(Q)(n.end_date)),1)])])])]))),128))]))])])])])]),e("div",{class:"sticky bottom-0 bg-white/95 backdrop-blur-sm px-4 sm:px-6 py-3 sm:py-4 border-t flex justify-end gap-3 safe-bottom"},[e("button",{onClick:c,class:"flex-1 sm:flex-none px-6 py-2.5 sm:py-2 bg-gray-900 text-white text-sm font-medium rounded-xl hover:bg-gray-800 active:bg-gray-950 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 transition-colors touch-manipulation"}," Fermer ")])])])):D("",!0)]),_:1})]))}}),Pt=Ce(Wt,[["__scopeId","data-v-e1c7cb0b"]]),Gt={class:"min-h-screen bg-gray-100"},Kt={class:"w-full py-6 px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16"},Qt={class:"text-2xl sm:text-3xl font-semibold text-gray-900 mb-6"},Yt={class:"bg-white p-4 sm:p-5 rounded-xl shadow-sm mb-6 border border-gray-100"},Zt={class:"flex flex-col sm:flex-row gap-4"},es={class:"flex-1"},ts=["placeholder"],ss={class:"sm:w-64"},os={value:"all"},ls={value:"disponible"},as={value:"loue"},ns={value:"maintenance"},rs={key:0,class:"text-center py-16"},is={class:"inline-flex items-center gap-3 text-gray-500"},ds={class:"text-lg"},us={key:1,class:"text-center py-16"},cs={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6"},ms={class:"relative w-full aspect-[4/3] bg-gray-100 overflow-hidden"},gs=["src","alt"],vs={class:"absolute bottom-3 right-3 bg-white rounded-lg p-2 shadow-md"},ps=["src","alt"],fs={class:"p-4 sm:p-5 flex-1 flex flex-col justify-between"},xs={class:"text-lg sm:text-xl font-semibold text-gray-900"},bs={class:"text-sm text-gray-500 mt-1"},ys={class:"mt-4"},hs=["onClick"],Ds=Z({__name:"Home",setup(T){const{cars:A,loading:h,fetchCars:M}=Ve();oe(),Me();const g=x({search:"",status:"all"}),k=x(!1),$=x(!1),s=x(null);De(()=>{M()});const f=I(()=>{let c=A.value;if(g.value.status!=="all"&&(c=c.filter(u=>u.status===g.value.status)),g.value.search){const u=g.value.search.toLowerCase();c=c.filter(m=>m.brand.toLowerCase().includes(u)||m.model.toLowerCase().includes(u)||m.plate_number.toLowerCase().includes(u))}return c}),V=c=>`/images/${c}.png`,_=c=>{s.value=c,$.value=!0},R=()=>{$.value=!1,s.value=null},q=()=>{k.value=!1,s.value=null},O=()=>{M()};return(c,u)=>(a(),i("div",Gt,[e("main",Kt,[e("div",null,[e("h1",Qt,d(c.$t("fleet.title")),1),e("div",Yt,[e("div",Zt,[e("div",es,[y(e("input",{"onUpdate:modelValue":u[0]||(u[0]=m=>g.value.search=m),type:"text",placeholder:c.$t("fleet.search_placeholder"),class:"border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-base py-3 px-4"},null,8,ts),[[C,g.value.search]])]),e("div",ss,[y(e("select",{"onUpdate:modelValue":u[1]||(u[1]=m=>g.value.status=m),class:"border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-base py-3 px-4"},[e("option",os,d(c.$t("fleet.all_statuses")),1),e("option",ls,d(c.$t("admin.fleet.disponible")),1),e("option",as,d(c.$t("admin.fleet.loue")),1),e("option",ns,d(c.$t("admin.fleet.maintenance")),1)],512),[[X,g.value.status]])])])]),r(h)?(a(),i("div",rs,[e("div",is,[u[2]||(u[2]=e("svg",{class:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e("span",ds,d(c.$t("fleet.loading")),1)])])):f.value.length===0?(a(),i("div",us,[...u[3]||(u[3]=[e("p",{class:"text-gray-500 text-lg"},"Aucune voiture trouvée.",-1)])])):(a(),i("div",cs,[(a(!0),i(S,null,j(f.value,m=>(a(),i("div",{key:m.id,class:"group bg-white rounded-xl shadow-sm hover:shadow-lg overflow-hidden flex flex-col h-full transition-all duration-300 border border-gray-100 hover:border-indigo-200"},[e("div",ms,[e("img",{src:m.image_url||"https://via.placeholder.com/400x300?text=No+Image",alt:`${m.brand} ${m.model}`,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"},null,8,gs),e("div",vs,[e("img",{src:V(m.brand),alt:m.brand,class:"h-8 w-8 object-contain"},null,8,ps)])]),e("div",fs,[e("div",null,[e("h3",xs,d(m.brand)+" "+d(m.model),1),e("p",bs,d(m.plate_number),1)]),e("div",ys,[e("button",{onClick:U=>_(m),class:"w-full flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"},[w(r(Se),{class:"w-5 h-5 mr-2"}),u[4]||(u[4]=ae(" Voir Plus / Disponibilité ",-1))],8,hs)])])]))),128))]))])]),w(dt,{show:k.value,car:s.value,onClose:q,onSuccess:O},null,8,["show","car"]),w(Pt,{show:$.value,car:s.value,onClose:R},null,8,["show","car"])]))}});export{Ds as default};
